<div class="container-fluid dashboard-container">
  <!-- Filtro de Período (as per previous suggestions, unchanged) -->
  <div class="period-filter mb-4">
    <div class="filter-content d-flex align-items-center justify-content-between p-3 rounded-lg shadow-sm" style="background: linear-gradient(135deg, #e0e7ff, #a5b4fc); border: 1px solid #bfdbfe;">
      <select class="form-select form-select-sm text-dark fw-semibold border-0 bg-transparent" [(ngModel)]="periodoSelecionado" (ngModelChange)="atualizarDados()">
        <option value="hoje">Hoje</option>
        <option value="semana">Última Semana</option>
        <option value="mes">Último Mês</option>
        <option value="custom">Personalizado</option>
      </select>
      
      <div class="custom-period d-flex align-items-center gap-2" *ngIf="periodoSelecionado === 'custom'">
        <input type="date" class="form-control form-control-sm border-0 bg-white rounded-pill shadow-sm" [(ngModel)]="dataInicial" (ngModelChange)="atualizarDados()">
        <span class="text-dark fw-medium">até</span>
        <input type="date" class="form-control form-control-sm border-0 bg-white rounded-pill shadow-sm" [(ngModel)]="dataFinal" (ngModelChange)="atualizarDados()">
      </div>
      
      <button class="btn btn-sm btn-primary rounded-pill shadow-sm" (click)="atualizarDados()">
        <i class="fas fa-sync-alt"></i> Atualizar
      </button>
    </div>
  </div>

  <!-- Cards de Métricas (Including Efficiency Cards Side by Side) -->
  <div class="metrics-container">
    <div class="metric-card gradient-bg-primary">
      <h6>Total de O.S.</h6>
      <h3>35</h3>
      <i class="fas fa-clipboard-list icon"></i>
    </div>
    <div class="metric-card gradient-bg-success">
      <h6>O.S. Realizadas</h6>
      <h3>28</h3>
      <i class="fas fa-check-circle icon"></i>
    </div>
    <div class="metric-card gradient-bg-warning">
      <h6>O.S. Não Atribuídas</h6>
      <h3>0</h3>
      <i class="fas fa-clock icon"></i>
    </div>
    <div class="metric-card gradient-bg-danger">
      <h6>O.S. Não Realizadas</h6>
      <h3>7</h3>
      <i class="fas fa-times-circle icon"></i>
    </div>
    <div class="metric-card gradient-bg-success">
      <h6>Eficiência Hoje</h6>
      <h3>80%</h3>
      <i class="fas fa-chart-pie icon"></i>
    </div>

    <div class="metric-card gradient-bg-info efficiency-general-wide">
      <h6>Eficiência Geral</h6>
      <div class="d-flex align-items-center justify-content-between">
        <div class="efficiency-circle" [ngClass]="{'low-efficiency': efficiencyGeneral < 50}">
          <span class="efficiency-value">{{ efficiencyGeneral }}%</span>
        </div>
        <div class="efficiency-stats">
          <p class="mb-1"><i class="fas fa-check-circle text-success"></i> O.S. Realizadas: 28</p>
          <p class="mb-1"><i class="fas fa-times-circle text-danger"></i> O.S. Não Realizadas: 7</p>
          <p class="mb-0"><i class="fas fa-clock text-warning"></i> O.S. Não Atribuídas: 0</p>
        </div>
      </div>
    </div>
    
  </div>

  <!-- Mapa de Colaboradores (Largura total) -->
  <div class="card shadow-lg mb-4">
    <div class="card-header">
      <h5>Localização dos Colaboradores</h5>
    </div>
    <div class="card-body p-0">
      <div id="map" style="height: 600px; width: 100%"></div>
    </div>
  </div>

  <!-- Tabela de Desempenho Detalhado -->
  <div class="table-container">
    <h5>Desempenho Detalhado</h5>
    <table class="table table-striped">
      <thead>
        <tr>
          <th>Foto</th>
          <th>Colaborador</th>
          <th>O.S. Atribuídas</th>
          <th>O.S. Realizadas</th>
          <th>O.S. Pendentes</th>
          <th>Tempo Médio</th>
          <th>Empresa</th>
          <th>Eficiência</th>
          <th>Jornada</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let colaborador of colaboradoresDesempenho">
          <td>
            <img [src]="colaborador.fotoUrl" alt="{{ colaborador.nome }}" class="profile-photo" />
          </td>
          <td>{{ colaborador.nome }}</td>
          <td>{{ colaborador.osAtribuidas }}</td>
          <td>{{ colaborador.osRealizadas }}</td>
          <td>{{ colaborador.osPendentes }}</td>
          <td>{{ colaborador.tempoMedio }}</td>
          <td>{{ colaborador.empresa }}</td>
          <td>
            <div class="progress">
              <div 
                class="progress-bar" 
                [ngClass]="{
                  'bg-success': colaborador.eficiencia >= 70,
                  'bg-warning': colaborador.eficiencia < 70 && colaborador.eficiencia >= 50,
                  'bg-danger': colaborador.eficiencia < 50
                }" 
                [style.width.%]="colaborador.eficiencia"
              >{{ colaborador.eficiencia }}%</div>
            </div>
          </td>
          <td>{{ colaborador.jornada }}</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>