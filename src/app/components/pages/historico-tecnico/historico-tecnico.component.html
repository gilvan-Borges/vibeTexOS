<!-- InformaÃ§Ãµes do UsuÃ¡rio -->
<div class="user-info-container">
  <div class="user-info-card">
    <div class="info-section">
      <div class="info-item">
        <span class="info-label">ğŸ‘¤ Colaborador:</span>
        <div class="user-status-container">
          <span class="info-value">{{ nomeUsuario }}</span>
          <span
            class="status-indicator"
            [ngClass]="{'online': isOnline, 'offline': !isOnline}"
          ></span>
        </div>
      </div>
      <div class="info-item">
        <span class="info-label">ğŸ•’ InÃ­cio do Expediente:</span>
        <span class="info-value">
          {{ horaInicioExpediente || 'NÃ£o iniciado' }}
        </span>
      </div>
      <div class="info-item">
        <span class="info-label">ğŸ Fim do Expediente:</span>
        <span
          class="info-value"
          [ngClass]="{'status-em-andamento': !horaFimExpediente}"
        >
          {{ horaFimExpediente || 'Em andamento' }}
        </span>
      </div>
    </div>

    <div class="date-filter-section">
      <div class="date-filter">
        <span class="info-label">ğŸ“… Selecione uma Data:</span>
        <input
          type="date"
          [(ngModel)]="dataSelecionada"
          (change)="filtrarPorData()"
          class="date-input"
          [max]="hoje"
        />
      </div>
    </div>
  </div>
</div>

<!-- Mapas -->
<div class="maps-container">
  <div class="map-box">
    <h3>LocalizaÃ§Ã£o Atual</h3>
    <div id="mapUserLocation" class="map"></div>
    <div class="map-actions">
      <button
        class="btn-location"
        (click)="verMinhaLocalizacao()"
        title="Ver minha localizaÃ§Ã£o atual"
      >
        ğŸ“ Ver Minha LocalizaÃ§Ã£o
      </button>
    </div>
  </div>

  <div class="map-box">
    <h3>Local de InÃ­cio do Expediente</h3>
    <div id="mapShiftLocation" class="map"></div>
  </div>
</div>

<!-- ContÃªiner para os trajetos -->
<div class="routes-container">
  <h3>ğŸš— Trajetos</h3>

  <div class="table-responsive">
    <!-- Mensagem quando nÃ£o hÃ¡ dados -->
    <div *ngIf="mensagemSemDados" class="alert alert-info text-center">
      {{ mensagemSemDados }}
    </div>

    <!-- Tabela sÃ³ Ã© mostrada quando hÃ¡ dados -->
    <table class="styled-table" *ngIf="!mensagemSemDados">
      <!-- Legenda para acessibilidade -->
      <caption>Lista de trajetos registrados</caption>
      <thead>
        <tr>
          <th (click)="ordenarPor('enderecoInicio')">
            Local de InÃ­cio â¬
          </th>
          <th (click)="ordenarPor('horaInicio')">
            Hora InÃ­cio â¬
          </th>
          <th (click)="ordenarPor('enderecoFim')">
            Local de Fim â¬
          </th>
          <th (click)="ordenarPor('horaFim')">
            Hora Fim â¬
          </th>
          <th>AÃ§Ãµes</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let trajeto of trajetosFiltrados">
          <td class="endereco-cell">
            {{ trajeto.enderecoInicio }}
            <button
              *ngIf="trajeto.latitudeInicio"
              class="btn-maps"
              (click)="abrirGoogleMapsComCoordenadas(trajeto.latitudeInicio, trajeto.longitudeInicio)"
              title="Ver no Google Maps"
            >
              ğŸ—ºï¸
            </button>
            <span
              *ngIf="trajeto.enderecoInicio === 'Carregando...'"
              class="loading-indicator"
            >
              âŒ›
            </span>
          </td>
          <td class="hora-cell">
            {{ trajeto.horaInicio || 'N/A' }}
          </td>
          <td class="endereco-cell">
            {{ trajeto.enderecoFim }}
            <button
              *ngIf="trajeto.latitudeFim"
              class="btn-maps"
              (click)="abrirGoogleMapsComCoordenadas(trajeto.latitudeFim, trajeto.longitudeFim)"
              title="Ver no Google Maps"
            >
              ğŸ—ºï¸
            </button>
            <span
              *ngIf="trajeto.enderecoFim === 'Carregando...'"
              class="loading-indicator"
            >
              âŒ›
            </span>
          </td>
          <td class="hora-cell">
            {{ trajeto.horaFim || 'N/A' }}
          </td>
          <td class="action-cell">
            <button
              class="btn-map"
              (click)="verNoMapa(trajeto)"
              title="Ver a rota no mapa"
            >
              â†
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
